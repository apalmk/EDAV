---
title: "Max graphs"
output: html_document
---

```{r}
library(ggplot2)
```



II - Superhero movie analysis

```{r}
df <- superhero_movie_dataframe # import superhero_movie_dataframe (from text, readr) directly to your environment
ticket_prices <- avg_ticket_price # import avg.ticket.price (from text, readr) from the datasets folder
ticket_prices[30,1] <- 1989
```

II - 1) Evaluating popularity over the years

To evaluate the popularity of superhero movies, we evaluate the number of people who have bought a ticket to see a movie. We roughly estimated the number of people who bought a ticket to be the revenue of the movie divided by the ticket price.

As the revenue graphs from Part I - Genre Analysis show, revenue for movies has consistently increased over time, but this increase is in large part due to inflation. To have a metric that is no longer affected by inflation, we will consider the number of people who bought a ticket for a movie to be the revenue of said movie divided by the average ticket price of the year in which the movie was released. 


```{r}
#getting revenue
movie_revenue <- sapply(df["gross_usa"],as.numeric)

#getting the year of release of each movie
movie_year <- sapply(df["year"],as.numeric)

ticket_year <- sapply(ticket_prices[1],as.numeric)
ticket_year[30] <- 
#Defining popularity as the quotient between revenue and average ticket price of the year

popularity <- c(1:length(movie_year))

for (i in 1:length(movie_year)){
  year <- movie_year[i]
  for (j in 1:length(ticket_year)){
      if (ticket_year[j] == year){
          ticket_price <- ticket_prices[j,2][[1]]
          ticket_price <- as.numeric(substr(ticket_price,2,nchar(ticket_price)))
          popularity[i] <- movie_revenue[i]/ticket_price
        }
  }
}

```

We group movies by year and compute the average popularity



```{r}
pop_frame = data.frame(year=movie_year,popularity=popularity)

scatter <- ggplot(pop_frame, aes(year, popularity)) + geom_point()
scatter +  labs(x = "Release Year", y = "Popularity (people)") +
  ggtitle("Popularity of superhero movies by release year")
```

We will now plot this new metric to see how popularity has evolved over the years.
We need to group 

```{r}
mean_pop_frame <- aggregate(pop_frame[, 2], list(pop_frame$year), mean)[ -c(1,2,35), ]

ggplot(data = mean_pop_frame, aes(x = Group.1, y = x))+
  geom_line(color = "blue") +
  ggtitle("Popularity of Superhero Movies over time") +
  labs(x = "year", y = "popularity (nb of tickets bought)")
```

The data indicates that superher movies (Marvel + DC) were popular before 1981 and made a resurgence since 1995. We also observe that from 1981 to 1995, superhero (Marvel + DC) movies were not popular at all. This indicates that the popularity of superhero movies has gone through several phases: popular(before 1981), unpopular (1981 - 1995), popular (since 1995). 

As the above graph shows, even in recent years, the popularity of superhero movies is not as evident as one might expect. While there are evident variations for the number of superhero movie tickets bought over time since 1995, when we account for inflation, there is no significant  increasing trend indicating that more people are buying movie tickets for superhero movies.

This could mean that the increase in revenue generated by superhero movies is primarily caused by inflation, and in reality, superhero movies in recent years have not been more popular than they were 20 years ago.


II - 6) Boxplots for Marvel and DC movies

Boxplot for scores faceted by Marvel movie or DC movie, with median, outliers, etc.


